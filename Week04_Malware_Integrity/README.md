Week 04 â€” File Integrity Monitoring and Malware Detection

Overview

This repository demonstrates a simple file integrity monitoring (FIM) workflow to detect tampering commonly associated with malware. It creates a baseline of file hashes and compares the current state to that baseline to flag modified, new, or deleted files.

Key concepts

- Integrity monitoring uses cryptographic hashes (here SHA-256) to detect changes to file contents.
- A secure baseline should be protected or cryptographically signed to prevent tampering.
- FIM detects changes but does not automatically determine whether a change is malicious.

Repository contents

- `integrity_baseline.py`: Scan a directory and write a `baseline.csv` of filename paths and SHA-256 hashes.
- `integrity_compare.py`: Recompute hashes for the same directory, compare them to `baseline.csv`, and write `change_report.csv` describing differences.
- `sample_folder/`: Example folder used by the scripts.

Quick start

1. Generate a baseline for the target directory (defaults to `sample_folder`):

```bash
python integrity_baseline.py
```

Output: `baseline.csv` (created in the working directory). Each row contains a file path and its SHA-256 digest.

2. Compare current files against the baseline:

```bash
python integrity_compare.py
```

Output: `change_report.csv` with entries classified as `modified`, `created`, or `deleted`.

Both scripts accept an optional directory path argument. Example:

```bash
python integrity_baseline.py /path/to/target
python integrity_compare.py /path/to/target
```

Behaviour and output

- `modified`: file exists but the SHA-256 hash differs from the baseline.
- `created`: file present now but absent from the baseline.
- `deleted`: file present in baseline but missing in the current scan.

Dependencies

No external packages are required; the scripts use only the Python standard library.

Security considerations and limitations

- No real-time monitoring: changes between scans will not be detected until the next run.
- Baseline tampering: if `baseline.csv` is altered, changes can be concealed.
- No signing: consider signing baselines or storing them on immutable/remote systems in production.
- No context: additional telemetry (process, timestamps, provenance) is needed to classify suspicious files.

Suggested next steps for production use

- Sign the baseline file and store it remotely or on a read-only medium.
- Integrate with real-time file system monitoring (inotify, FSEvents) for near-real-time detection.
- Correlate findings with process and network telemetry to better assess malicious intent.

Acknowledgements

This exercise is designed to illustrate integrity monitoring fundamentals and how cryptographic hashing supports tamper detection and forensic validation.